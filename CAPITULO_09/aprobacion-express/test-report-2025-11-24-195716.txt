================================================================================
REPORTE DE PRUEBAS FUNCIONALES
Sistema de Pre-Aprobacion Crediticia Express
================================================================================

Fecha de ejecucion: 2025-11-24 19:57:16
Sistema operativo: macOS
Modo Quarkus: JVM Local
Microservicio: http://localhost:8080
Version: test-aprobacion.sh v2.0

================================================================================


============================================================================
PRUEBAS FUNCIONALES - SISTEMA DE PRE-APROBACION CREDITICIA
============================================================================


============================================================================
FASE 0: ARRANQUE DE INFRAESTRUCTURA
============================================================================


>>> Verificando requisitos

[OK] Docker funcionando
[OK] Docker Compose disponible

>>> Iniciando PostgreSQL (docker-compose)

[INFO] Esperando que PostgreSQL este listo...
[OK] PostgreSQL listo (BD: banco_credito)

>>> Compilando y ejecutando Quarkus (JVM local)

[INFO] Compilando proyecto...
[OK] Compilacion exitosa
[INFO] Iniciando Quarkus...
[INFO] Esperando que Quarkus este listo...
[OK] Quarkus listo (PID: 79612)
[OK] Infraestructura lista!

============================================================================
PRUEBA 1: HEALTH CHECKS
============================================================================


>>> 1.1 - Liveness Probe

[INFO] Verificando: http://localhost:8080/q/health/live
Respuesta:
{
  "status": "UP",
  "checks": []
}
[OK] TEST #1: Health check - Liveness

>>> 1.2 - Readiness Probe

[INFO] Verificando: http://localhost:8080/q/health/ready
Respuesta:
{
  "status": "UP",
  "checks": [
    {
      "name": "Database connections health check",
      "status": "UP",
      "data": {
        "<default>": "UP"
      }
    }
  ]
}
[OK] TEST #2: Health check - Readiness

============================================================================
PRUEBA 2: ESTADISTICAS DEL SISTEMA
============================================================================


>>> 2.1 - Consultar estadisticas

[INFO] Obteniendo: http://localhost:8080/api/preaprobacion/estadisticas
Estadisticas:
{
  "tasaAprobacion": 66.67,
  "totalSolicitudes": 10,
  "enEvaluacion": 0,
  "pendientes": 1,
  "rechazadas": 3,
  "aprobadas": 6
}
[OK] TEST #3: Consultar estadisticas

============================================================================
PRUEBA 3: SOLICITUD APROBADA - CLIENTE PERFIL EXCELENTE
============================================================================


>>> 3.1 - Crear solicitud

[INFO] Enviando solicitud (DNI: 70001234)...

[INFO] Resultado:
{
  "solicitudId": 11,
  "aprobado": true,
  "scoreCalculado": 783,
  "montoMaximoAprobado": 50000.00,
  "tasaInteres": 9.50,
  "plazoMaximoMeses": 84,
  "motivosRechazo": [],
  "recomendaciones": [],
  "tiempoEvaluacionMs": 172,
  "fechaEvaluacion": "2025-11-24T19:57:36.63013",
  "nivelRiesgo": "BAJO"
}
[OK] Solicitud APROBADA como se esperaba
[OK] TEST #4: Cliente perfil excelente aprobado

============================================================================
PRUEBA 4: SOLICITUD APROBADA - CLIENTE CON GARANTIA
============================================================================


>>> 4.1 - Crear solicitud

[INFO] Enviando solicitud (DNI: 70005678)...

[INFO] Resultado:
{
  "solicitudId": 12,
  "aprobado": true,
  "scoreCalculado": 776,
  "montoMaximoAprobado": 30000.00,
  "tasaInteres": 9.50,
  "plazoMaximoMeses": 84,
  "motivosRechazo": [],
  "recomendaciones": [],
  "tiempoEvaluacionMs": 127,
  "fechaEvaluacion": "2025-11-24T19:57:38.704183",
  "nivelRiesgo": "BAJO"
}
[OK] Solicitud APROBADA como se esperaba
[OK] TEST #5: Cliente con garantia aprobado

============================================================================
PRUEBA 5: SOLICITUD RECHAZADA - CLIENTE EN LISTA NEGRA
============================================================================


>>> 5.1 - Crear solicitud

[INFO] Enviando solicitud (DNI: 12345678 - lista negra)...

[INFO] Resultado:
{
  "solicitudId": 13,
  "aprobado": false,
  "scoreCalculado": 594,
  "motivosRechazo": [
    "Cliente figura en lista negra del bureau crediticio"
  ],
  "recomendaciones": [],
  "tiempoEvaluacionMs": 132,
  "fechaEvaluacion": "2025-11-24T19:57:41.505115",
  "nivelRiesgo": "CRITICO"
}
[OK] Solicitud RECHAZADA como se esperaba
[OK] TEST #6: Cliente lista negra rechazado

============================================================================
PRUEBA 6: SOLICITUD RECHAZADA - DEUDA MUY ALTA
============================================================================


>>> 6.1 - Crear solicitud

[INFO] Enviando solicitud (deuda 5x mayor que ingreso)...

[INFO] Resultado:
{
  "solicitudId": 14,
  "aprobado": false,
  "scoreCalculado": 684,
  "motivosRechazo": [
    "Ratio deuda/ingreso demasiado alto (máximo aceptable: 40%)"
  ],
  "recomendaciones": [
    "Reduzca su nivel de endeudamiento actual antes de solicitar nuevo crédito"
  ],
  "tiempoEvaluacionMs": 140,
  "fechaEvaluacion": "2025-11-24T19:57:43.847941",
  "nivelRiesgo": "ALTO"
}
[OK] Solicitud RECHAZADA como se esperaba
[OK] TEST #7: Cliente deuda alta rechazado

============================================================================
PRUEBA 7: VALIDACIONES DE ENTRADA
============================================================================


>>> 7.1 - Ingreso negativo

[INFO] Enviando solicitud con ingreso negativo...
[OK] Validacion correcta (HTTP 400)
[OK] TEST #8: Validacion ingreso negativo

>>> 7.2 - Edad menor a 18

[INFO] Enviando solicitud con edad = 17...
[OK] Validacion correcta (HTTP 400)
[OK] TEST #9: Validacion edad minima

============================================================================
PRUEBA 8: CONSULTA DE SOLICITUDES
============================================================================


>>> 8.1 - Consultar solicitud existente

[WARN] No hay ID disponible, omitiendo

>>> 8.2 - Consultar solicitud inexistente

[INFO] Consultando ID: 999999...
[OK] Respuesta correcta (HTTP 404)
[OK] TEST #10: Consultar solicitud inexistente

============================================================================
PRUEBA 9: LISTADO DE SOLICITUDES
============================================================================


>>> 9.1 - Listar con paginacion

[INFO] Obteniendo lista (page=0, size=5)...
{
  "total": 14,
  "size": 5,
  "totalPages": 3,
  "page": 0,
  "solicitudes": [
    {
      "id": 1,
      "numeroDocumento": "45678901",
      "tipoDocumento": "DNI",
      "nombreCompleto": "María Elena Fernández Torres",
      "ingresoMensual": 8500.00,
      "montoSolicitado": 50000.00,
      "deudaActual": 5000.00,
      "antiguedadLaboralAnios": 12,
      "edad": 38,
      "tieneGarantia": true,
      "tipoGarantia": "HIPOTECARIA",
      "fechaSolicitud": "2025-10-20T10:30:00",
      "estado": "APROBADO",
      "scoreCalculado": 820,
      "montoAprobado": 50000.00,
      "tasaInteres": 10.00,
      "plazoMaximoMeses": 84,
      "tiempoEvaluacionMs": 145,
      "fechaEvaluacion": "2025-10-20T10:30:00"
    },
    {
      "id": 2,
      "numeroDocumento": "56789012",
      "tipoDocumento": "DNI",
      "nombreCompleto": "Carlos Alberto Mendoza Ríos",
      "ingresoMensual": 5000.00,
      "montoSolicitado": 30000.00,
      "deudaActual": 8000.00,
      "antiguedadLaboralAnios": 6,
      "edad": 42,
      "tieneGarantia": true,
      "tipoGarantia": "VEHICULAR",
      "fechaSolicitud": "2025-10-21T14:15:00",
      "estado": "APROBADO",
      "scoreCalculado": 685,
      "montoAprobado": 30000.00,
      "tasaInteres": 12.50,
      "plazoMaximoMeses": 60,
      "tiempoEvaluacionMs": 152,
      "fechaEvaluacion": "2025-10-21T14:15:00"
    },
    {
      "id": 3,
      "numeroDocumento": "22222222",
      "tipoDocumento": "DNI",
      "nombreCompleto": "Pedro José Ramírez Gómez",
      "ingresoMensual": 3500.00,
      "montoSolicitado": 15000.00,
      "deudaActual": 7000.00,
      "antiguedadLaboralAnios": 3,
      "edad": 35,
      "tieneGarantia": false,
      "tipoGarantia": null,
      "fechaSolicitud": "2025-10-22T09:45:00",
      "estado": "APROBADO",
      "scoreCalculado": 625,
      "montoAprobado": 15000.00,
      "tasaInteres": 15.00,
      "plazoMaximoMeses": 36,
      "tiempoEvaluacionMs": 178,
      "fechaEvaluacion": "2025-10-22T09:45:00"
    },
    {
      "id": 4,
      "numeroDocumento": "67890123",
      "tipoDocumento": "DNI",
      "nombreCompleto": "Ana Patricia Silva Montes",
      "ingresoMensual": 2500.00,
      "montoSolicitado": 20000.00,
      "deudaActual": 12000.00,
      "antiguedadLaboralAnios": 2,
      "edad": 28,
      "tieneGarantia": false,
      "tipoGarantia": null,
      "fechaSolicitud": "2025-10-22T11:20:00",
      "estado": "RECHAZADO",
      "scoreCalculado": 485,
      "montoAprobado": null,
      "tasaInteres": null,
      "plazoMaximoMeses": null,
      "tiempoEvaluacionMs": 163,
      "fechaEvaluacion": "2025-10-22T11:20:00"
    },
    {
      "id": 5,
      "numeroDocumento": "12345678",
      "tipoDocumento": "DNI",
      "nombreCompleto": "Roberto Carlos Delgado Pérez",
      "ingresoMensual": 4000.00,
      "montoSolicitado": 25000.00,
      "deudaActual": 3000.00,
      "antiguedadLaboralAnios": 5,
      "edad": 40,
      "tieneGarantia": true,
      "tipoGarantia": "PRENDARIA",
      "fechaSolicitud": "2025-10-22T16:00:00",
      "estado": "RECHAZADO",
      "scoreCalculado": 320,
      "montoAprobado": null,
      "tasaInteres": null,
      "plazoMaximoMeses": null,
      "tiempoEvaluacionMs": 141,
      "fechaEvaluacion": "2025-10-22T16:00:00"
    }
  ]
}
[INFO] Total solicitudes: 14
[OK] TEST #11: Listar solicitudes

============================================================================
RESUMEN DE PRUEBAS
============================================================================


RESULTADOS FINALES
==================
Total de pruebas: 11
Pruebas exitosas: 11
Pruebas fallidas: 0

[OK] TODAS LAS PRUEBAS PASARON EXITOSAMENTE!
CONCLUSION: Sistema funcionando correctamente.

================================================================================
FIN DEL REPORTE - 2025-11-24 19:57:49
================================================================================
[OK] Reporte guardado en: test-report-2025-11-24-195716.txt
[WARN] Limpiando recursos...

>>> Deteniendo Quarkus

[OK] Proceso detenido (PID: 79612)
