================================================================
              PRUEBAS - PERFIL TEST                            
              Testing: Ambiente controlado                     
================================================================

Sistema Operativo: mac
Python: python3
Fecha: 20/11/2025 09:26:39
API Base: http://localhost:8080
Resultados: test-test-2025-11-20_09-26-39.txt
Perfil: TEST (testing)

IMPORTANTE: El servidor se arrancara automaticamente en perfil test
El script manejara: Compilacion, arranque, pruebas y limpieza

Caracteristicas del perfil TEST:
  - Comision: 1.5% (moderada)
  - Limite transaccional: 1,000 (bajo para pruebas)
  - Cache: Activado
  - Auditoria: Activada
  - Proveedor: FreeCurrencyAPI
  - Vault: Desactivado


================================================================
PREPARACION Y COMPILACION
================================================================

Matando procesos previos de Quarkus y Java...
Limpieza completada

Compilando aplicacion...
Compilacion exitosa

Arrancando aplicacion en modo TEST...

PID de la aplicacion: 63466

Esperando a que la aplicacion arranque (timeout: 60s)...
Aplicacion lista en perfil TEST


================================================================
PRUEBA 1: Configuracion del Perfil TEST
================================================================

Objetivo: Verificar que la aplicacion esta en perfil TEST
Endpoint: GET /api/tasas/config
Esperado: perfil_activo=test, comision=1.5%, limite=1,000

Ejecutando consulta de configuracion...

Response (HTTP 200):
{
  "auditoria_habilitada": true,
  "monedas_soportadas": [
    "USD",
    "EUR",
    "MXN"
  ],
  "refresh_minutos": 30,
  "ambiente": "testing",
  "aplicacion": "TasaCorp API",
  "moneda_base": "PEN",
  "perfil_activo": "test",
  "comision_porcentaje": 1.5,
  "api_key_source": "application.properties",
  "proveedor": "FreeCurrencyAPI",
  "proveedor_url": "https://api.freecurrencyapi.com/v1/latest",
  "limite_transaccional": 1000,
  "cache_habilitado": true
}

PASS - Configuracion TEST obtenida correctamente
Validaciones:
  [OK] Perfil: test
  [OK] Comision: 1.5%
  [OK] Limite: 1,000
  [OK] Proveedor: FreeCurrencyAPI

Resultado esperado:
   perfil_activo: 'test'
   comision_porcentaje: 1.5
   limite_transaccional: 1000

================================================================
PRUEBA 2: Conversion con Comision 1.5%
================================================================

Objetivo: Verificar que TEST cobra comision del 1.5%
Endpoint: GET /api/tasas/convertir/USD?monto=1000
Operacion: Convertir 1,000 PEN a USD
Esperado: comision > 0

Ejecutando conversion...

Response (HTTP 200):
{
  "monto_origen": 1000.0,
  "moneda_origen": "PEN",
  "monto_convertido": 3750.0,
  "moneda_destino": "USD",
  "tasa_aplicada": 3.75,
  "comision": 56.25,
  "monto_total": 3806.25,
  "proveedor": "FreeCurrencyAPI",
  "limite_transaccional": 1000,
  "dentro_limite": true
}

PASS - Conversion realizada correctamente
Desglose de la conversion:
  Monto Original: $1,000 PEN
  Monto Convertido: $3,750.00 USD
  Comision (1.5%): $56.25 USD
  Total: $3,806.25 USD
  Dentro de Limite: True

[OK] TEST cobra comision del 1.5%

Resultado esperado:
   La comision debe ser mayor a 0 (1.5% del monto convertido)
   El monto de 1,000 debe estar dentro del limite

================================================================
PRUEBA 3: Detectar Limite Excedido
================================================================

Objetivo: Verificar deteccion de limite excedido
Endpoint: GET /api/tasas/convertir/USD?monto=1500
Operacion: Convertir 1,500 PEN (excede limite de 1,000)
Esperado: dentro_limite: false

Ejecutando conversion con monto que excede limite...

Response (HTTP 200):
{
  "monto_origen": 1500.0,
  "moneda_origen": "PEN",
  "monto_convertido": 5625.0,
  "moneda_destino": "USD",
  "tasa_aplicada": 3.75,
  "comision": 84.375,
  "monto_total": 5709.375,
  "proveedor": "FreeCurrencyAPI",
  "limite_transaccional": 1000,
  "dentro_limite": false
}

PASS - Respuesta obtenida correctamente
Analisis del limite excedido:
  Monto Solicitado: $1,500
  Limite Transaccional: $1,000
  Dentro de Limite: False

[OK] Se detecto que excede el limite
[INFO] En un sistema real, esto rechazaria la transaccion

Resultado esperado:
   dentro_limite: false (1,500 > 1,000)

================================================================
                    RESUMEN DE PRUEBAS                         
================================================================

  Total de tests:      3
  Tests Exitosos:  3
  Tests Fallidos:  0

================================================================
                   TESTS EJECUTADOS                            
================================================================

PRUEBA 1: Configuracion del perfil TEST verificada
PRUEBA 2: Conversion con comision moderada (1.5%)
PRUEBA 3: Deteccion de limite excedido verificada

================================================================
              CARACTERISTICAS DEL PERFIL TEST                  
================================================================

Optimizado para:       Pruebas en ambiente controlado
Comision:              1.5% (moderada)
Limite:                1,000 (bajo para pruebas)
Cache:                 Activado (rendimiento)
Auditoria:             Activada (trazabilidad)
Proveedor:             FreeCurrencyAPI (API gratuita)
Vault:                 Desactivado

================================================================
                    ARCHIVO DE LOG                             
================================================================

Todas las pruebas han sido guardadas en:
   test-test-2025-11-20_09-26-39.txt

Puedes revisar el log completo en cualquier momento para:
   - Verificar las respuestas HTTP completas
   - Analizar la configuracion del perfil TEST
   - Confirmar el comportamiento de limites
   - Compartir los resultados con tu instructor
   - Documentar el comportamiento del sistema

Deteniendo la aplicacion...
Matando procesos previos de Quarkus y Java...
Limpieza completada

Pruebas del perfil TEST completadas exitosamente!
Continua con: test-part2-prod.sh (perfil PROD)

