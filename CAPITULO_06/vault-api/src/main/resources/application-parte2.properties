# ═══════════════════════════════════════════════════════════════════════════
# PARTE 2: AUTENTICACIÓN CON JWT (JSON WEB TOKEN)
# ═══════════════════════════════════════════════════════════════════════════
# Esta configuración habilita JWT con firma RSA usando claves locales.
# El JWT es generado por el endpoint /api/auth/login y firmado con privateKey.pem
#
# Para ejecutar esta parte:
#   ./mvnw quarkus:dev -Dquarkus.profile=parte2
#
# O en Windows (Git Bash):
#   ./mvnw quarkus:dev -Dquarkus.profile=parte2
#
# Endpoints disponibles:
#   - POST /api/auth/login                (público - genera JWT)
#   - GET  /api/internal/secrets/profile  (requiere JWT válido)
#   - GET  /api/internal/secrets/my-secrets (requiere JWT válido)
#   - POST /api/internal/secrets          (requiere JWT válido)
#
# Usuarios de prueba:
#   - emp001 / pass001  (Juan Pérez)
#   - emp002 / pass002  (María González)
#
# Flujo:
#   1. Login → Obtener token JWT
#   2. Usar token en header: Authorization: Bearer <token>
#   3. Acceder a endpoints protegidos
# ═══════════════════════════════════════════════════════════════════════════

# Habilitar usuarios embebidos (necesarios para el login)
quarkus.security.users.embedded.enabled=true
quarkus.security.users.embedded.plain-text=true

# Usuarios para autenticación JWT
quarkus.security.users.embedded.users.emp001=pass001
quarkus.security.users.embedded.roles.emp001=employee

quarkus.security.users.embedded.users.emp002=pass002
quarkus.security.users.embedded.roles.emp002=employee

# Configuración JWT con claves RSA locales
mp.jwt.verify.publickey.location=publicKey.pem
mp.jwt.verify.issuer=https://vaultcorp.com
smallrye.jwt.sign.key.location=privateKey.pem

# No verificar el claim azp (no es necesario para JWT simple)
smallrye.jwt.claims.azp.required=false

# Tolerancia para diferencias de timestamp (60 segundos)
mp.jwt.verify.clock.skew=60

# IMPORTANTE: Deshabilitar OIDC completamente para esta parte
quarkus.oidc.enabled=false

# Mantener Basic Auth deshabilitado para esta parte
quarkus.http.auth.basic=false